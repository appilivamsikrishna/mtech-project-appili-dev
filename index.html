<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MTech Project</title>
    <link rel="stylesheet" href="styles.css" />
    <!-- SweetAlert CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css"
    />
  </head>
  <body>
    <!-- Header -->
    <header>
      <h1>Appili Vamsi Krishna - MTech Project - IIT Madras</h1>
    </header>

    <!-- Main Content -->
    <main>
      <!-- Video Section -->
      <section class="video-section">
        <h2>Project Video</h2>
        <video controls autoplay muted>
          <source src="./assets/mtech-project-video.MP4" type="video/mp4" />
          Your browser does not support the video tag.
        </video>
        <p>for audio, kindly unmute the video</p>
      </section>

      <!-- PDF Download Section -->
      <section class="pdf-section">
        <h2>Project Document</h2>
        <button id="download-btn" class="download-button">
          Download MTech Project Report
        </button>
        <iframe
          src="./assets/AE20M002_MTech_Thesis.pdf"
          width="100%"
          height="500px"
        ></iframe>
      </section>
    </main>

    <!-- Footer -->
    <footer>
      <p>
        Â© <span id="year"></span> Appili Vamsi Krishna | MTech Project | IIT
        Madras
      </p>
    </footer>

    <!-- SweetAlert and JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
      // Get the current year dynamically
      const currentYear = new Date().getFullYear();
      document.getElementById("year").textContent = currentYear;

      // Download PDF button functionality
      document
        .getElementById("download-btn")
        .addEventListener("click", function () {
          // Create an invisible <a> element
          const link = document.createElement("a");

          // Append a random query string to avoid caching issues
          const filePath = "./assets/AE20M002_MTech_Thesis.pdf";
          link.href = filePath + "?t=" + new Date().getTime(); // Add timestamp

          link.download = "Appili_Vamsi_Krishna_MTech_Project_Report.pdf"; // Name for the downloaded file

          // Append the link to the document body and trigger the click event
          document.body.appendChild(link);
          link.click();

          // Remove the link element from the DOM after triggering the download
          document.body.removeChild(link);

          // Show SweetAlert confirmation
          Swal.fire({
            icon: "success",
            title: "Download complete!",
            text: "Appili Vamsi Krishna MTech Thesis document has been downloaded.",
            confirmButtonText: "OK",
          });
        });
    </script>

    <script>
      // Function to adjust iframe height to be 110% of A4 aspect ratio
      function adjustIframeHeight() {
        const iframe = document.querySelector(".pdf-section iframe");
        const width = iframe.offsetWidth;
        const aspectRatio = 1.414; // A4 aspect ratio
        iframe.style.height = (width / aspectRatio) * 1.1 + "px"; // 110% of A4 height
      }

      // Call the function on window load and resize
      window.addEventListener("load", adjustIframeHeight);
      window.addEventListener("resize", adjustIframeHeight);
    </script>
  </body>
</html>
